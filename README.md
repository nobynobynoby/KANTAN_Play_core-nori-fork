# KANTAN_Play_core（のり私家Fork版）

> ※このリポジトリは [`InstaChord/KANTAN_Play_core`](https://github.com/InstaChord/KANTAN_Play_core) の私家Fork（のり版）です。

---

## 元READMEについて

元リポジトリのREADME内容は [`README_original.md`](./README_original.md) にそのまま収録しています。  
詳細な仕様や説明はこちらをご覧ください。

---

## このForkの変更点・追加機能
- 本家Ver 0.4.5取り込み

- UART-MIDIカスタマイズ対応
  - [`M5Stack用MIDI音源ユニット`](https://www.switch-science.com/products/9928)想定
  - 各MIDIチャンネル(≒パート)ごとに内部MIDIとUART-MIDIへの出力の切り替えの設定を追加
  - UART-MIDIのマスターボリューム設定を、内部MIDIと分けて設定できるよう変更
  - ※パートの設定は現状内部レジストリに保存していませんその都度用設定。UARTボリュームは保存していますが、初期値は0です。

- ノートモードの音色変更
  - スロット設定メニューの末尾にノートモードの音色を選択する機能を追加
  - ノートモードの音色をユーザーソングスデータに保持/読み込みする機能を追加
  - ノートモードのスケールをユーザーソングスデータに保持/読み込みする機能を追加  

- PbHUB接続機能の追加
  - [`Unit Pbhub v1.1`](https://docs.m5stack.com/en/unit/pbhub_1.1)を使用できるように修正。アドレス0x61～0x64、使用ポートは0～3限定(4,5は使用不可)
  - 各Grove端子に[`Unit Dual Button`](https://docs.m5stack.com/en/unit/dual_button)の接続を想定

- 組み合わせの追加機能
  - 5/7,3~/6b追加(追加サンプル)
  - 4機能組み合わせ時の境界チェック漏れ修正

- ロック機能の追加
  - ベースロック(B-Lock)機能追加。ロックボタン押下後、他のコードボタンでシーケンスを進めてもベースはオンコードとして残りづける。
  - コードロック(C-Lock)機能追加。ロックボタン押下後、他のコードボタンでシーケンスを進めてもベースのみがコードに追従し、ベース音以外はロック時のコードのままシーケンスが進む。
  - 双方ロック時には他のコードボタンが押されてもアルペジエータは先頭に戻らない(同じコードボタンが押されている扱い)
  - ※現状ベース音側の調号(♯♭)は未対応

- BLE-MIDIの修正・追加についてはすべて破棄(本家ver 0.4.5で問題解決しているので)


---

## ブランチ運用について

- 安定版は `main` ブランチ  
- 開発用は `develop` ブランチを使用  
- 各機能ごとに独立したブランチで開発中です

---

ご質問・要望があればお気軽にお問い合わせください。
